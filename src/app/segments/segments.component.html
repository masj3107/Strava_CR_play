<h1 class="table-title">My Segments</h1>

<div id="map"></div>
<br>

<div class="summary-grid">
    <h2>CRs Taken Per Year</h2>
    <div class="grid-container">
      <div *ngFor="let year of crsPerYear | keyvalue" class="grid-item">
        <mat-icon class="crown-icon">emoji_events</mat-icon>
        <span class="year">{{ year.key }}</span>: 
        <strong>{{ year.value }}</strong> CRs
      </div>
    </div>
</div>

<!-- ✅ Updated: Material Table with Header, Rows, and Sorting -->
<table mat-table [dataSource]="dataSource" matSort class="styled-table">

  <!-- Type Column -->
  <ng-container matColumnDef="type">
    <th mat-header-cell *matHeaderCellDef mat-sort-header></th>
    <td mat-cell *matCellDef="let segment">
      <mat-icon *ngIf="segment.type === 'Run'">directions_run</mat-icon>
      <mat-icon *ngIf="segment.type === 'Nordic Ski'">downhill_skiing</mat-icon>
    </td>
  </ng-container>

  <!-- Name Column -->
  <ng-container matColumnDef="name">
    <th mat-header-cell *matHeaderCellDef mat-sort-header>Name</th>
    <td mat-cell *matCellDef="let segment">
      <a [href]="segment.link" target="_blank">{{ segment.name }}</a>
    </td>
  </ng-container>

  <!-- Distance Column -->
  <ng-container matColumnDef="distance_km">
    <th mat-header-cell *matHeaderCellDef mat-sort-header>Dist (km)</th>
    <td mat-cell *matCellDef="let segment">{{ segment.distance_km }}</td>
  </ng-container>

  <!-- Elevation Column -->
  <ng-container matColumnDef="elevation_m">
    <th mat-header-cell *matHeaderCellDef mat-sort-header>Elev (m)</th>
    <td mat-cell *matCellDef="let segment">{{ segment.elevation_m }}</td>
  </ng-container>

  <!-- Time Column -->
  <ng-container matColumnDef="time">
    <th mat-header-cell *matHeaderCellDef mat-sort-header>Time</th>
    <td mat-cell *matCellDef="let segment">
      <a [href]="segment.time_link" target="_blank">{{ segment.time }}</a>
    </td>
  </ng-container>

  <!-- Efforts Column -->
  <ng-container matColumnDef="effort_count">
    <th mat-header-cell *matHeaderCellDef mat-sort-header>Efforts</th>
    <td mat-cell *matCellDef="let segment">
      <mat-icon color="accent">bar_chart</mat-icon> {{ segment.effort_count }}
    </td>
  </ng-container>

  <!-- Athletes Column -->
  <ng-container matColumnDef="athlete_count">
    <th mat-header-cell *matHeaderCellDef mat-sort-header>Athletes</th>
    <td mat-cell *matCellDef="let segment">
      <mat-icon color="accent">group</mat-icon> {{ segment.athlete_count }}
    </td>
  </ng-container>

  <!-- Date Column -->
  <ng-container matColumnDef="date">
    <th mat-header-cell *matHeaderCellDef mat-sort-header>Date</th>
    <td mat-cell *matCellDef="let segment">{{ segment.date }}</td>
  </ng-container>

  <!-- ✅ Required: Define Header and Rows -->
  <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
  <tr mat-row *matRowDef="let row; columns: displayedColumns;"></tr>

</table>
